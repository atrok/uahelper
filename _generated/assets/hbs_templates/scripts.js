define(["handlebars"], function(Handlebars) { return Handlebars.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    return "<script src=\"/assets/js/socket.io.js \"></script>\n<script src=\"https://code.jquery.com/jquery-3.3.1.min.js\"></script>\n<script type=\"text/javascript\" src=\"/assets/js/loading-bar.min.js\"></script>\n<script>\n\n\n\n    // function to hide and show progress bar and other elements\n    (function ($) {\n        $.fn.invisible = function () {\n            return this.css(\"visibility\", \"hidden\");\n        };\n        $.fn.visible = function () {\n            return this.css(\"visibility\", \"visible\");\n        };\n    })(jQuery);\n\n\n\n\n    var socket = io.connect('/prepareadvisory');\n\n    var bar1 = new ldBar(\"#myItem1\");\n    //var bar2 = document.getElementById('myItem1').ldBar;\n\n    var id;\n    socket.on('connected', function (data) {\n        console.log(data);\n        id = data.id;\n        socket.emit('tasks', {});\n    });\n\n    socket.on('progress', function (data) {\n        console.log(data.percents);\n        bar1.set(data.percents);\n    })\n\n    socket.on('result', function (data) {\n        console.log(data);\n        $(\"#div_result #resultsTable\").empty();\n\n        Object.keys(data).forEach((key) => { $(\"#div_result #result\").append(data[key]); })\n\n        $('.tableresultheader').click(function () {\n            $header = $(this);\n            $content = $header.next();\n            $content.slideToggle(500, function () {\n                $header.text(function () {\n                    return $content.is(':visible') ? 'Collapse' : 'Expand';\n                });\n            });\n        });\n\n\n    })\n\n    socket.on('console', function (data) {\n        console.log(data);\n        //$(\"#div_result\").empty();\n        Object.keys(data).forEach((key) => { $(\"#div_result #console\").append(data[key]); })\n\n\n    })\n\n    socket.on('errors', function (data) {\n        console.log(data);\n        //$(\"#div_result\").empty();\n        lotsoferrors(data);\n\n\n    })\n\n    socket.on('done', function (data) {\n        done();\n    })\n\n    socket.on('validation', function (data) {\n        console.log(data);\n        $(':submit').attr('disabled', 'disabled');\n        if (data.submitted) {\n            $(\"#div_result #console\").append(data.reason);\n        } else {\n            lotsoferrors(data.reason)\n            done();\n        }\n    })\n\n    socket.on('tasks', function (data) {\n        console.log('Got list of tasks');\n        if (data instanceof Array) {\n            data.forEach((item) => {\n                $('#tasks').append(\n                    '<tr id=\"' + item.id + '\">'\n                    + '<td><input type=\"checkbox\" id=\"' + item.id + '\" /></td>'\n                    + '<td>' + item.time.toString() + '</td>'\n                    + '<td>' + item.input.toString() + '</td>'\n                    + '<td>' + item.link.toString() + '</td>'\n                    + '</tr>'\n                )\n            })\n            $(document).ready(function () {\n                $(\".getresult\").click(function () {\n                    var id = this.id;\n                    submitData('getresults', { 'id': id })\n                });\n            });\n        }\n    })\n\n    socket.on('deleted', function (data) {\n        console.log('Record deleted: ', data.id);\n        $('tr#' + data.id).remove();\n    })\n\n    $(\"#form_dbs\").submit(function () {\n        try {\n            var args = {};\n            var errors = []\n            args.dbtype = $(\"select option:selected\").attr(\"value\");\n\n            args.host = (checkField($(\"#host\").val(), 100)) ? $(\"#host\").val() : errors.push('Host can\\'t be longer than 100');\n            args.dbname = (checkField($(\"#dbname\").val(), 100)) ? $(\"#dbname\").val() : errors.push('DB name can\\t be longer than 100');\n            args.user = (checkField($(\"#user\").val(), 100)) ? $(\"#user\").val() : errors.push('User can\\'t be longer than 100');\n            args.pass = (checkField($(\"#pass\").val(), 25)) ? $(\"#pass\").val() : errors.push('Password can\\'t be longer than 25');\n\n            var res = {};\n            res.form = 'form_dbs';\n            res.args = args;\n            if (!lotsoferrors(errors))\n                submitData('my other event', res);\n\n\n            //alert(args);;\n\n        } catch (e) {\n            console.log(e.stack);\n        } finally {\n            return false; // to avoid page reload\n        } // to avoid page reload\n\n    })\n    $(\"#form_comp\").submit(function () {\n        try {\n            var args = {};\n            var errors = []\n            args.apptype = $(\"#apptype option:selected\").attr(\"value\");\n            args.ostype = $(\"#ostype option:selected\").attr(\"value\");\n\n            args.release = (checkField($(\"#release\").val(), 10)) ? $(\"#release\").val() : errors.push('Release can\\'t be longer than 10');\n            var res = {}\n            res.form = 'form_comp';\n            res.args = args;\n            if (!lotsoferrors(errors)) {\n                submitData('search', res);\n\n            }\n\n        } catch (e) {\n            console.log(e.stack);\n        } finally {\n            return false; // to avoid page reload\n        } // to avoid page reload\n\n    })\n\n    $(\"#form_tasks\").submit(function () {\n        try {\n            var args = {};\n            var errors = []\n            args = checkedValues(\"#form_tasks input:checkbox:checked\");\n\n\n\n            submitData('deleteresults', args);\n            //alert(args);;\n\n        } catch (e) {\n            console.log(e.stack);\n        } finally {\n            return false; // to avoid page reload\n        } // to avoid page reload\n\n    })\n\n        $(\"#form_admin\").submit(function () {\n        try {\n            var args = {};\n            args.databases = $(\"#databases option:selected\").attr(\"value\");\n\n            submitData('recreate_view', args);\n            //alert(args);;\n\n        } catch (e) {\n            console.log(e.stack);\n        } finally {\n            return false; // to avoid page reload\n        } // to avoid page reload\n\n    })\n\n    function done() {\n        $(':submit').removeAttr('disabled');\n        $('div #myItem1').invisible();\n    }\n    function submitData(channel, data) {\n        socket.emit(channel, data);\n        $('div #myItem1').visible();\n    }\n\n    var checkField = function (text, condition) {\n        return (text.length > condition) ? false : true;\n    }\n\n    var lotsoferrors = function (errors) {\n        var err;\n        if (errors instanceof Array) {\n            err = errors;\n        } else {// object kv pairs\n            err = [];\n            Object.keys(errors).forEach((k) => {\n\n                err.push('<span class=\"error\">' + k + ':</span> ' + errors[k]);\n            })\n\n        }\n        if (err.length > 0) {\n            $(\"#form_errors\").empty();\n\n            $(\"#form_errors\").append('<div id=\"errors\"><h3>Error!</h3><span onclick=\"this.parentElement.style.display=\\'none\\'\"  class=\"w3-button w3-display-topright\">X</span></div>');\n            var s;\n            err.forEach((val) => { $(\"#errors\").append(val + '<br/>') });\n            return true;\n\n        } else {\n            $(\"#errors\").remove();\n            return false;\n        }\n    }\n\n    var checkedValues = function (name) {\n        return $(name).map(function () {\n            return this.id;\n        }).get();\n    }\n\n    function openTab(evt, tabName) {\n        var i;\n        var x = document.getElementsByClassName(\"tab\");\n        for (i = 0; i < x.length; i++) {\n            x[i].style.display = \"none\";\n        }\n\n        tablinks = document.getElementsByClassName(\"tablink\");\n        for (i = 0; i < x.length; i++) {\n            tablinks[i].className = tablinks[i].className.replace(\" w3-red\", \"\");\n        }\n        document.getElementById(tabName).style.display = \"block\";\n        evt.currentTarget.className += \" w3-red\";\n    }\n\n</script>";
},"useData":true}); });