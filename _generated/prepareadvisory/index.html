<html>

<head>
	<title>Support Architect Tools</title>
	<link rel="stylesheet" href="/assets/css/main.css">
	<link href="https://fonts.googleapis.com/css?family=Lato:100,200" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="/assets/css/loading-bar.css" />
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
	<style type="text/css"></style>


</head>

<body>

	<section class='screen'>


		<div class="page_name">
			<p class="huge">Upgrade Advisory tool</p>
		</div>
		 
    <div class="header_menu">
        <ul class="horiz_menu">
            <li>
                <a href="/prepareadvisory" >Upgrade Advisory</a>
            </li>
            <li>
                <a href="/topologybuilder" >Topology builder</a>
            </li>
            <li>
                <a href="/compareconfig" >Configuration Comparison tool</a>
            </li>
        </ul>
    </div>


		<div class="w3-bar w3-black">

			<button class="w3-bar-item w3-button  tablink w3-red" onclick="openTab(event, 'db')">Database</button>
			<button class="w3-bar-item w3-button  tablink" onclick="openTab(event, 'app')">Application</button>
			<button class="w3-bar-item w3-button  tablink" onclick="openTab(event, 'csv')">File</button>
			<button class="w3-bar-item w3-button  tablink" onclick="openTab(event, 'lists')">Saved configurations</button>
			<button class="w3-bar-item w3-button  tablink" onclick="openTab(event, 'admin')">Views management</button>

		</div>
		<div id="forms" class="left">
			<div id="db" class='tab height300'>
				<form id="form_dbs" class="appnitro">



					<h1>Enter DB connection details</h1>
					<ul>

						<li id="li_dbtype">
							<label class="description" for="element_1">DBMS type</label>
							<div>
								<select class="dropdown_select">
									<option value='oracle' selected>Oracle</option>
									<option value='mssql'>MSSQL</option>
								</select>
							</div>
						</li>

						<li id="li_host">
							<label class="description" for="element_2">Host</label>
							<div>
								<input id="host" name="host" class="element text medium" type="text" size="25" maxlength="255" value='' />
							</div>
						</li>
						<li id="li_dbname">
							<label class="description" for="element_3">Database name(Mssql)/Schema Name(Oracle)</label>
							<div>
								<input id="dbname" name="dbname" class="element text medium" type="text" size="25" maxlength="255" value="" />
							</div>
						</li>
						<li id="li_user">
							<label class="description" for="element_4">Username</label>
							<div>
								<input id="user" name="user" class="element text medium" type="text" size="25" maxlength="255" value="" />
							</div>
						</li>
						<li id="li_pass">
							<label class="description" for="element_5">Password</label>
							<div>
								<input id="pass" name="pass" class="element text medium" type="password" size="25" maxlength="255" value="" />
							</div>
						</li>
						<li id="li_genfile">
							<label class="description" for="element_5" class="form_element_height">Generate report on server</label>
								<input type="checkbox"  id="genfile_d" name="genfile" class="form_element_height width40" />
						</li>
						<li id="li_3">

							<li class="buttons">
								<input type="hidden" name="form_id" value="68250" />

								<button>Connect</button>
							</li>
					</ul>

				</form>
			</div>

			<div id="app" class="tab height300" style="display:none">
				<form id="form_comp">
					<h1>Select component</h1>
					<ul>
						<li>
							<label class="description" for="element_0">Solution</label>
							<div class="dropdown">
								<select id="solution" class="dropdown_select">
									
								</select>
							</div>
						</li>
						<li>
							<label class="description" for="element_1">Component</label>
							<div class="dropdown">
								<select id="apptype" class="dropdown_select">
									<option size="25" value='.NET Web API Server and Samples'>.NET Web API Server and Samples</option>
									<option size="25" value='Aastra MXONE CSTA I'>Aastra MXONE CSTA I</option>
									<option size="25" value='Administration Console'>Administration Console</option>
									<option size="25" value='Alcatel A4400/OXE'>Alcatel A4400/OXE</option>
									<option size="25" value='API'>API</option>
									<option size="25" value='Aspect ACD'>Aspect ACD</option>
									<option size="25" value='Authoring Tool'>Authoring Tool</option>
									<option size="25" value='Avaya Communication Manager'>Avaya Communication Manager</option>
									<option size="25" value='Avaya TSAPI'>Avaya TSAPI</option>
									<option size="25" value='Backend'>Backend</option>
									<option size="25" value='Builder'>Builder</option>
									<option size="25" value='Business Process for use with Facebook'>Business Process for use with Facebook</option>
									<option size="25" value='Business Process for use with RSS'>Business Process for use with RSS</option>
									<option size="25" value='Business Process for use with Twitter'>Business Process for use with Twitter</option>
									<option size="25" value='Call Control Platform'>Call Control Platform</option>
									<option size="25" value='Call Progress Detection Server'>Call Progress Detection Server</option>
									<option size="25" value='CCPulse+'>CCPulse+</option>
									<option size="25" value='Chat Server'>Chat Server</option>
									<option size="25" value='Cisco Adapter'>Cisco Adapter</option>
									<option size="25" value='Classification Server'>Classification Server</option>
									<option size="25" value='CMS'>CMS</option>
									<option size="25" value='Configuration Database Maintenance Scripts'>Configuration Database Maintenance Scripts</option>
									<option size="25" value='Configuration Manager'>Configuration Manager</option>
									<option size="25" value='Configuration Server'>Configuration Server</option>
									<option size="25" value='Configuration Utility'>Configuration Utility</option>
									<option size="25" value='Contact Center Advisor - Mobile Edition'>Contact Center Advisor - Mobile Edition</option>
									<option size="25" value='Contact Center Advisor - Mobile Edition Android Client'>Contact Center Advisor - Mobile Edition Android Client</option>
									<option size="25" value='Contact Center Advisor - Mobile Edition Blackberry Client'>Contact Center Advisor - Mobile Edition Blackberry Client</option>
									<option size="25" value='Contact Center Advisor - Mobile Edition iOS Client'>Contact Center Advisor - Mobile Edition iOS Client</option>
									<option size="25" value='Contact Center Advisor &amp; Workforce Advisor'>Contact Center Advisor &amp; Workforce Advisor</option>
									<option size="25" value='Content Analyzer Plug-in for GAX'>Content Analyzer Plug-in for GAX</option>
									<option size="25" value='CSTA Connector'>CSTA Connector</option>
									<option size="25" value='CSTA Connector for BroadSoft BroadWorks'>CSTA Connector for BroadSoft BroadWorks</option>
									<option size="25" value='CTI Connector'>CTI Connector</option>
									<option size="25" value='Custom Server'>Custom Server</option>
									<option size="25" value='Daemon'>Daemon</option>
									<option size="25" value='Data Aggregator'>Data Aggregator</option>
									<option size="25" value='Data Mart'>Data Mart</option>
									<option size="25" value='Data Modeling Assistant'>Data Modeling Assistant</option>
									<option size="25" value='Data Sourcer'>Data Sourcer</option>
									<option size="25" value='Database Utility'>Database Utility</option>
									<option size="25" value='DB Server'>DB Server</option>
									<option size="25" value='Development Tool'>Development Tool</option>
									<option size="25" value='Device Management Plug-in for Genesys Administrator Extension'>Device Management Plug-in for Genesys Administrator Extension</option>
									<option size="25" value='E-mail Server'>E-mail Server</option>
									<option size="25" value='EADS Intecom M6880'>EADS Intecom M6880</option>
									<option size="25" value='Engine'>Engine</option>
									<option size="25" value='eServices Manager Plug-in for GAX'>eServices Manager Plug-in for GAX</option>
									<option size="25" value='Fetching Module'>Fetching Module</option>
									<option size="25" value='Frontend'>Frontend</option>
									<option size="25" value='Frontline Advisor and Agent Advisor'>Frontline Advisor and Agent Advisor</option>
									<option size="25" value='Genesys Adapter'>Genesys Adapter</option>
									<option size="25" value='Genesys Administrator'>Genesys Administrator</option>
									<option size="25" value='Genesys Administrator Extension'>Genesys Administrator Extension</option>
									<option size="25" value='Genesys Administrator Extension HPE SPD'>Genesys Administrator Extension HPE SPD</option>
									<option size="25" value='Genesys Agent Scripting'>Genesys Agent Scripting</option>
									<option size="25" value='Genesys Care Workbench Agent'>Genesys Care Workbench Agent</option>
									<option size="25" value='Genesys Care Workbench Log Extractor'>Genesys Care Workbench Log Extractor</option>
									<option size="25" value='Genesys Care Workbench Server'>Genesys Care Workbench Server</option>
									<option size="25" value='Genesys Cloud API Driver for  Facebook'>Genesys Cloud API Driver for  Facebook</option>
									<option size="25" value='Genesys Cloud API Driver for  Twitter'>Genesys Cloud API Driver for  Twitter</option>
									<option size="25" value='Genesys Co-browse Server'>Genesys Co-browse Server</option>
									<option size="25" value='Genesys Data Processing Server'>Genesys Data Processing Server</option>
									<option size="25" value='Genesys Driver for Use with Facebook'>Genesys Driver for Use with Facebook</option>
									<option size="25" value='Genesys Driver for Use with RSS'>Genesys Driver for Use with RSS</option>
									<option size="25" value='Genesys Driver for Use with Twitter'>Genesys Driver for Use with Twitter</option>
									<option size="25" value='Genesys Info Mart'>Genesys Info Mart</option>
									<option size="25" value='Genesys Info Mart Manager'>Genesys Info Mart Manager</option>
									<option size="25" value='Genesys Interactive Insights'>Genesys Interactive Insights</option>
									<option size="25" value='Genesys Mobile Services'>Genesys Mobile Services</option>
									<option size="25" value='Genesys One Base Pack'>Genesys One Base Pack</option>
									<option size="25" value='Genesys One Email Pack'>Genesys One Email Pack</option>
									<option size="25" value='Genesys One HA Pack'>Genesys One HA Pack</option>
									<option size="25" value='Genesys Pulse'>Genesys Pulse</option>
									<option size="25" value='Genesys Pulse Collector'>Genesys Pulse Collector</option>
									<option size="25" value='Genesys Quality Management'>Genesys Quality Management</option>
									<option size="25" value='Genesys SIP Voicemail'>Genesys SIP Voicemail</option>
									<option size="25" value='Genesys SIP Voicemail Complete Install'>Genesys SIP Voicemail Complete Install</option>
									<option size="25" value='Genesys Softphone'>Genesys Softphone</option>
									<option size="25" value='Genesys SR Service'>Genesys SR Service</option>
									<option size="25" value='Genesys T-Server and UCMA Connector for Skype for Business'>Genesys T-Server and UCMA Connector for Skype for Business</option>
									<option size="25" value='Hosted Provider Edition'>Hosted Provider Edition</option>
									<option size="25" value='Hosted Provider Edition Agent Desktop Proxy'>Hosted Provider Edition Agent Desktop Proxy</option>
									<option size="25" value='Interaction Recording Web Services'>Interaction Recording Web Services</option>
									<option size="25" value='Interaction Routing Designer'>Interaction Routing Designer</option>
									<option size="25" value='Interaction Server'>Interaction Server</option>
									<option size="25" value='Interaction Server Cluster Plug-in for GAX'>Interaction Server Cluster Plug-in for GAX</option>
									<option size="25" value='Interaction Server Proxy'>Interaction Server Proxy</option>
									<option size="25" value='Interaction Workflow Samples'>Interaction Workflow Samples</option>
									<option size="25" value='Interaction Workspace'>Interaction Workspace</option>
									<option size="25" value='Interaction Workspace Plug-in for Facebook'>Interaction Workspace Plug-in for Facebook</option>
									<option size="25" value='Interaction Workspace Plug-in for Genesys Agent Scripting'>Interaction Workspace Plug-in for Genesys Agent Scripting</option>
									<option size="25" value='Interaction Workspace Plug-in for RSS'>Interaction Workspace Plug-in for RSS</option>
									<option size="25" value='Interaction Workspace Plug-in for Twitter'>Interaction Workspace Plug-in for Twitter</option>
									<option size="25" value='IVR Driver for MPS'>IVR Driver for MPS</option>
									<option size="25" value='IVR Driver for WVR for AIX'>IVR Driver for WVR for AIX</option>
									<option size="25" value='IVR Library'>IVR Library</option>
									<option size="25" value='IVR SDK'>IVR SDK</option>
									<option size="25" value='IVR Server'>IVR Server</option>
									<option size="25" value='iWD Data Mart'>iWD Data Mart</option>
									<option size="25" value='iWD GAX Plug-In'>iWD GAX Plug-In</option>
									<option size="25" value='iWD Manager'>iWD Manager</option>
									<option size="25" value='iWD Runtime Node'>iWD Runtime Node</option>
									<option size="25" value='iWD Setup Utility'>iWD Setup Utility</option>
									<option size="25" value='iWD Stat Server Extensions'>iWD Stat Server Extensions</option>
									<option size="25" value='iWD Web'>iWD Web</option>
									<option size="25" value='Java Environment and Libraries for eServices and UCS'>Java Environment and Libraries for eServices and UCS</option>
									<option size="25" value='Knowledge Manager'>Knowledge Manager</option>
									<option size="25" value='License Reporting Manager'>License Reporting Manager</option>
									<option size="25" value='Load Distribution Server'>Load Distribution Server</option>
									<option size="25" value='Local Control Agent'>Local Control Agent</option>
									<option size="25" value='Log File Management Tool Client'>Log File Management Tool Client</option>
									<option size="25" value='Log File Management Tool Collector'>Log File Management Tool Collector</option>
									<option size="25" value='Log File Management Tool Indexer'>Log File Management Tool Indexer</option>
									<option size="25" value='Manager'>Manager</option>
									<option size="25" value='Media Control Platform'>Media Control Platform</option>
									<option size="25" value='Message Server'>Message Server</option>
									<option size="25" value='MIB'>MIB</option>
									<option size="25" value='Mitel MiTAI'>Mitel MiTAI</option>
									<option size="25" value='Mitel MiVoice'>Mitel MiVoice</option>
									<option size="25" value='MRCP Proxy'>MRCP Proxy</option>
									<option size="25" value='Multi-Channel Routing Extensions'>Multi-Channel Routing Extensions</option>
									<option size="25" value='NEC NEAX/APEX'>NEC NEAX/APEX</option>
									<option size="25" value='Nortel Communication Server 1000 with SCCS/MLS'>Nortel Communication Server 1000 with SCCS/MLS</option>
									<option size="25" value='Nortel Communication Server 2000/2100'>Nortel Communication Server 2000/2100</option>
									<option size="25" value='Orchestration Server'>Orchestration Server</option>
									<option size="25" value='Outbound Contact Center Extension'>Outbound Contact Center Extension</option>
									<option size="25" value='Outbound Contact Server'>Outbound Contact Server</option>
									<option size="25" value='Platform'>Platform</option>
									<option size="25" value='Platform SDK &amp; Application Blocks for .NET'>Platform SDK &amp; Application Blocks for .NET</option>
									<option size="25" value='Platform SDK &amp; Application Blocks for Java'>Platform SDK &amp; Application Blocks for Java</option>
									<option size="25" value='Platform SDK for .NET'>Platform SDK for .NET</option>
									<option size="25" value='Platform SDK for Java'>Platform SDK for Java</option>
									<option size="25" value='Plug-in for GAX'>Plug-in for GAX</option>
									<option size="25" value='Plug-in for Genesys Administrator Extension'>Plug-in for Genesys Administrator Extension</option>
									<option size="25" value='Plug-in for Interaction Workspace'>Plug-in for Interaction Workspace</option>
									<option size="25" value='Plug-in for Workspace Desktop Edition'>Plug-in for Workspace Desktop Edition</option>
									<option size="25" value='Plugin for Administrator'>Plugin for Administrator</option>
									<option size="25" value='Plugin for Genesys Administrator Extension'>Plugin for Genesys Administrator Extension</option>
									<option size="25" value='Plugin for Workspace Desktop Edition'>Plugin for Workspace Desktop Edition</option>
									<option size="25" value='Policy Server'>Policy Server</option>
									<option size="25" value='Privacy Manager Plugin for GAX'>Privacy Manager Plugin for GAX</option>
									<option size="25" value='PSTN Connector'>PSTN Connector</option>
									<option size="25" value='Recording Crypto Server'>Recording Crypto Server</option>
									<option size="25" value='Recording Muxer Script'>Recording Muxer Script</option>
									<option size="25" value='Recording Plug-in for Genesys Administrator Extension'>Recording Plug-in for Genesys Administrator Extension</option>
									<option size="25" value='Recording Processor Script'>Recording Processor Script</option>
									<option size="25" value='Reporting and Analytics Aggregates'>Reporting and Analytics Aggregates</option>
									<option size="25" value='Reporting Dashboard Proxy for Genesys Administrator Extension'>Reporting Dashboard Proxy for Genesys Administrator Extension</option>
									<option size="25" value='Reporting Plug-in for GAX'>Reporting Plug-in for GAX</option>
									<option size="25" value='Reporting Server'>Reporting Server</option>
									<option size="25" value='Resource Manager'>Resource Manager</option>
									<option size="25" value='Sample Reporting Templates'>Sample Reporting Templates</option>
									<option size="25" value='SAP BusinessObjects Business Intelligence Platform Client 3.1.x'>SAP BusinessObjects Business Intelligence Platform Client 3.1.x</option>
									<option size="25" value='SAP BusinessObjects Business Intelligence Platform Client 4.1.x'>SAP BusinessObjects Business Intelligence Platform Client 4.1.x</option>
									<option size="25" value='SAP BusinessObjects Business Intelligence Platform Client ServicePack 3.1.x'>SAP BusinessObjects Business Intelligence Platform Client ServicePack 3.1.x</option>
									<option size="25" value='SAP BusinessObjects Business Intelligence Platform Client ServicePack 4.1.x'>SAP BusinessObjects Business Intelligence Platform Client ServicePack 4.1.x</option>
									<option size="25" value='SAP BusinessObjects Business Intelligence Platform Server 3.1.x'>SAP BusinessObjects Business Intelligence Platform Server 3.1.x</option>
									<option size="25" value='SAP BusinessObjects Business Intelligence Platform Server 4.1.x'>SAP BusinessObjects Business Intelligence Platform Server 4.1.x</option>
									<option size="25" value='SAP BusinessObjects Business Intelligence Platform Server Service Pack 3.1.x'>SAP BusinessObjects Business Intelligence Platform Server Service Pack 3.1.x</option>
									<option size="25" value='SAP BusinessObjects Business Intelligence Platform Server ServicePack 4.1.x'>SAP BusinessObjects Business Intelligence Platform Server ServicePack 4.1.x</option>
									<option size="25" value='Security Pack on UNIX'>Security Pack on UNIX</option>
									<option size="25" value='Server'>Server</option>
									<option size="25" value='Siemens HiPath 4000 CSTA III'>Siemens HiPath 4000 CSTA III</option>
									<option size="25" value='SIP Endpoint SDK for .NET'>SIP Endpoint SDK for .NET</option>
									<option size="25" value='SIP Endpoint SDK for Apple OS'>SIP Endpoint SDK for Apple OS</option>
									<option size="25" value='SIP Feature Server'>SIP Feature Server</option>
									<option size="25" value='SIP Proxy'>SIP Proxy</option>
									<option size="25" value='SIP Server'>SIP Server</option>
									<option size="25" value='sipspan2'>sipspan2</option>
									<option size="25" value='SMS Server'>SMS Server</option>
									<option size="25" value='SNMP Master Agent'>SNMP Master Agent</option>
									<option size="25" value='Social Media Plug-in for Workspace Desktop Edition'>Social Media Plug-in for Workspace Desktop Edition</option>
									<option size="25" value='Social Messaging Plugin for Genesys Agent Desktop'>Social Messaging Plugin for Genesys Agent Desktop</option>
									<option size="25" value='Social Messaging Server'>Social Messaging Server</option>
									<option size="25" value='Solution Control Server'>Solution Control Server</option>
									<option size="25" value='Spectrum'>Spectrum</option>
									<option size="25" value='Stat Server'>Stat Server</option>
									<option size="25" value='Supplementary Services Gateway'>Supplementary Services Gateway</option>
									<option size="25" value='T-Server Common Part'>T-Server Common Part</option>
									<option size="25" value='T-Server-CUCM to Media Server Connector'>T-Server-CUCM to Media Server Connector</option>
									<option size="25" value='Third-Party Squid'>Third-Party Squid</option>
									<option size="25" value='Training Server'>Training Server</option>
									<option size="25" value='UCS Manager'>UCS Manager</option>
									<option size="25" value='Universal Contact Server'>Universal Contact Server</option>
									<option size="25" value='Universal Contact Server Manager'>Universal Contact Server Manager</option>
									<option size="25" value='Universal Contact Server Proxy'>Universal Contact Server Proxy</option>
									<option size="25" value='Universal Routing Server'>Universal Routing Server</option>
									<option size="25" value='VP Reporting Plugin for GAX'>VP Reporting Plugin for GAX</option>
									<option size="25" value='Web'>Web</option>
									<option size="25" value='Web API Server'>Web API Server</option>
									<option size="25" value='Web API Server for WebLogic'>Web API Server for WebLogic</option>
									<option size="25" value='Web API Server for WebSphere'>Web API Server for WebSphere</option>
									<option size="25" value='Web Services and Applications'>Web Services and Applications</option>
									<option size="25" value='Widgets'>Widgets</option>
									<option size="25" value='Workspace Desktop Edition'>Workspace Desktop Edition</option>
									<option size="25" value='Workspace Plugin for Skype for Business'>Workspace Plugin for Skype for Business</option>
								</select>
							</div>
						</li>

						<li>
							<label class="description" for="element_1">Version</label>
							<div >
								<input id="release" name="release" class="element text medium" type="text" size="25" maxlength="255" value="" />
							</div>
						</li>
						<li>
							<label class="description" for="element_1">OS type</label>
							<div class="dropdown">
								<select id="ostype" class="dropdown_select">
									<option value='solaris'>Solaris</option>
									<option value='solaris'>Solaris x86</option>
									<option value='trux'>Tru64 Unix</option>
									<option value='hpux'>HP-UX</option>
									<option value='aix'>IBM AIX</option>
									<option value='sunos'>SunOS</option>
									<option value='windows'>Windows NT</option>
									<option value='windows'>Windows</option>
									<option value='ibmos2'>IBM OS2</option>
									<option value='macintosh'>Macintosh</option>
									<option value='tandemux'>Tandem UNIX</option>
									<option value='uxware'>UNIX Ware</option>
									<option value='windows'>Windows 2000</option>
									<option value='windows'>Windows XP</option>
									<option value='windows'>Windows Server 2003</option>
									<option value='linux'>RedHat Enterprise Linux AS/Intel</option>
									<option value='windows'>Windows Server 2008</option>
									<option value='windows'>Windows Vista</option>
									<option value='windows'>Windows Server 2012</option>
								</select>
							</div>
						</li>

						<li id="li_genfile">
							<label class="description" for="element_5" class="form_element_height">Generate report on server</label>
								<input type="checkbox"  id="genfile_a" name="genfile" class="form_element_height width40" />
						</li>

						<li>

							<div>
								<button>Search</button>
							</div>
						</li>
				</form>
			</div>

			<div id="csv" class="tab height300" style="display:none">
				<form id="form_csv">
					<h1>Upload CSV file with component versions</h1>
					<ul>

						<li>
	
							<div >
								<input id="uploadInput" type="file" name="myFiles" onchange="handleFiles(event);">
							</div>
						</li>
						<li >
							<label class="description" for="element_5" class="form_element_height">File has a header</label>
								<input type="checkbox"  id="hasHeader" name="hasHeader" class="form_element_height width40" />
						</li>

						<li id="li_genfile">
							<label class="description" for="element_5" class="form_element_height">Generate report on server</label>
								<input type="checkbox"  id="genfile_c" name="genfile" class="form_element_height width40" />
						</li>
						<li>

							<div>
								<button>Run</button>
							</div>
						</li>
				</form>
			</div>

			<div id="lists" class="tab height300" style="display:none">
				<form id="form_lists">
					<h1>Load components from saved configuration</h1>
					<p>Create configuration lists either from Application tab or by uploading csv file with list of components</p>
					<ul>
						<li>
							<label class="description" for="element_0">Saved configurations</label>
							<div class="dropdown">
								<select id="solution" class="dropdown_select">
									
								</select>
							</div>
						</li>

						<li id="li_genfile">
							<label class="description" for="element_5" class="form_element_height">Generate report on server</label>
								<input type="checkbox"  id="genfile_d" name="genfile" class="form_element_height width40" />
						</li>

						<li>

							<div>
								<button>Run</button>
							</div>
						</li>
				</form>
			</div>

			<div id="admin" class="tab height300" style="display:none">
				<form id="form_admin">
					<h1>Choose Database to recreate views</h1>
					<ul>

						<li>
							<label class="description" for="element_1">Databases</label>
							<div class="dropdown">
								<select id="databases" class="dropdown_select">
									<option size="25" value='genesys_releases'>genesys_releases</option>
								</select>
							</div>
						</li>

						<li>

							<div>
								<button>Run</button>
							</div>
						</li>
				</form>
			</div>

		</div>

		<div class='content left'>

			<div id='div_result'>
				
<!--div class="ldBar" data-value=""></div -->
<div id="myItem1"></div>
<form id="form_generate">
    <div id="result">

    </div>
    <div id="generate" style="visibility: hidden">
<label>Generate report:</label>
        <button id='docx'>Docx</button>
        <button id='xlsx'>Xlsx</button>

    </div>
</form>
<div id="tasksContainer">
    <h3>Executed tasks</h3>
    <form id="form_tasks">
        <table id="tasks">
            <tr>
                <th>Delete</th>
                <th>Time</th>
                <th>Arguments</th>
                <th>ID</th>
            </tr>
        </table>
        <div>
            <button>Delete</button>
        </div>
    </form>
</div>

<div id="console"></div> <script src="/assets/js/socket.io.js "></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="/assets/js/loading-bar.min.js"></script>
<script src="/assets/js/docxtemplater-latest.min.js"></script>
<script src="/assets/js/jszip.min.js"></script>
<script src="/assets/js/file-saver.min.js"></script>
<script src="/assets/js/jszip-utils.js"></script>
<script src="/assets/js/LineReader.js"></script>
<!--
    Mandatory in IE 6, 7, 8 and 9.
    -->
<!--[if IE]>
        <script type="text/javascript" src="examples/vendor/jszip-utils-ie.js"></script>
    <![endif]-->
<script>



    // function to hide and show progress bar and other elements
    (function ($) {
        $.fn.invisible = function () {
            return this.css("visibility", "hidden");
        };
        $.fn.visible = function () {
            return this.css("visibility", "visible");
        };
    })(jQuery);




    var obj = [];
    var components={
        file:{
            name:'',
            size:0, 
            mimeType:''
        },
        components:[]
    };

    var socket = io.connect('/prepareadvisory');

    var bar1 = new ldBar("#myItem1");
    //var bar2 = document.getElementById('myItem1').ldBar;

    var id;
    socket.on('connected', function (data) {
        console.log(data);
        id = data.id;
        socket.emit('tasks', {});
        socket.emit('get_solutions', {});
    });

    socket.on('solutions', function (data) { //populate solutions dropdown list

        if (data) {
            console.log(data);
            Object.keys(data).forEach((key) => {
                $("#solution").append("<option size=25 value='" + data[key].key + "'>" + data[key].key + "</option>");
            });
        }
        // attaching event listeners to process generate document requests;

        $(document).ready(function () {
            solutions = document.getElementById("solution");
            document.getElementById("solution").addEventListener("change", function () {

                solutions.options[solutions.options.selectedIndex].selected = true;
                socket.emit('get_components', $("#solution option:selected").attr("value"));

                return false;

            });
        });
    })

    socket.on('components', function (data) {
        console.log(data);
        if (data) {
            removeOptions(document.getElementById("apptype"))
            Object.keys(data).forEach((key) => {
                $("#apptype").append("<option size=25 value='" + data[key].key[1] + "'>" + data[key].key[1] + "</option>");
            });

            // since we add options dynamically we need to set selected flag on change event
            $(document).ready(function () {
                applications = document.getElementById("apptype");
                document.getElementById("apptype").addEventListener("change", function () {

                    applications.options[applications.options.selectedIndex].selected = true;
                    return false;

                });
            });
        }
    })

    socket.on('progress', function (data) {
        console.log(data.percents);
        bar1.set(data.percents);
    })

    socket.on('result', function (data) {
        console.log(data);
        $("#generate").visible();
        $("#div_result #resultsTable").empty();

        // remove all hidden inputs
        var fields = $("#form_generate :input").serializeArray();
        $.each(fields, function (i, field) {
            $("input[name='" + field.value + "']").remove();
        });

        // clearing the cache
        obj = [];

        // saving object for postprocesing in cache
        if (data.parsed_obj) {
            obj[data._id] = data.parsed_obj;
            $("#generate").append("<input type='hidden' name='" + data._id + "' value='" + data._id + "' />");
        }

        Object.keys(data).forEach((key) => {
            if (key === 'file' || key === 'error' || key == 'table') // 
                $("#div_result #result").append(data[key]);
        })



        $('.tableresultheader').click(function () {
            $header = $(this);
            $content = $header.next();
            $content.slideToggle(500, function () {
                $header.text(function () {
                    return $content.is(':visible') ? 'Collapse' : 'Expand';
                });
            });
        });

        // attaching event listeners to process generate document requests;

        $(document).ready(function () {
            document.getElementById("docx").addEventListener("click", function () {

                var values = {};
                var fields = $("#form_generate :input").serializeArray();
                $.each(fields, function (i, field) {
                    values = obj[field.value];
                });

                var generator = new Generator();

                generator.generateDocx("/assets/js/input.docx", values);

                return false;

            });
        });


    })

    socket.on('console', function (data) {
        console.log(data);
        //$("#div_result").empty();
        Object.keys(data).forEach((key) => { $("#div_result #console").append(data[key]); })


    })

    socket.on('errors', function (data) {
        console.log(data);
        //$("#div_result").empty();
        lotsoferrors(data);


    })

    socket.on('done', function (data) {
        done();
    })

    socket.on('validation', function (data) {
        console.log(data);
        $(':submit').attr('disabled', 'disabled');
        if (data.submitted) {
            $("#div_result #console").append(data.reason);
        } else {
            lotsoferrors(data.reason)
            done();
        }
    })

    socket.on('tasks', function (data) {
        console.log('Got list of tasks');
        if (data instanceof Array) {
            data.forEach((item) => {
                $('#tasks').append(
                    '<tr id="' + item.id + '">'
                    + '<td><input type="checkbox" id="' + item.id + '" /></td>'
                    + '<td>' + item.time.toString() + '</td>'
                    + '<td>' + item.input.toString() + '</td>'
                    + '<td>' + item.link.toString() + '</td>'
                    + '</tr>'
                )
            })
            $(document).ready(function () {
                $(".getresult").click(function () {
                    var id = this.id;
                    submitData('getresults', { 'id': id })
                });
            });
        }
    })

    socket.on('deleted', function (data) {
        console.log('Record deleted: ', data.id);
        $('tr#' + data.id).remove();
    })

    $("#form_dbs").submit(function () {
        try {
            var args = {};
            var errors = []
            args.dbtype = $("select option:selected").attr("value");

            args.host = (checkField($("#host").val(), 100)) ? $("#host").val() : errors.push('Host can\'t be longer than 100');
            args.dbname = (checkField($("#dbname").val(), 100)) ? $("#dbname").val() : errors.push('DB name can\t be longer than 100');
            args.user = (checkField($("#user").val(), 100)) ? $("#user").val() : errors.push('User can\'t be longer than 100');
            args.pass = (checkField($("#pass").val(), 25)) ? $("#pass").val() : errors.push('Password can\'t be longer than 25');
            args.genfile = $('#genfile_d').is(':checked') ? true : false;

            var res = {};
            res.form = 'form_dbs';
            res.args = args;
            if (!lotsoferrors(errors))
                submitData('my other event', res);


            //alert(args);;

        } catch (e) {
            console.log(e.stack);
        } finally {
            return false; // to avoid page reload
        } // to avoid page reload

    })
    $("#form_comp").submit(function () {
        try {
            var args = {};
            var errors = []
            args.solution=$("#solution option:selected").attr("value");
            args.apptype = $("#apptype option:selected").attr("value");
            args.ostype = $("#ostype option:selected").attr("value");
            args.genfile = $('#genfile_a').is(':checked') ? true : false;

            args.release = (checkField($("#release").val(), 10)) ? $("#release").val() : errors.push('Release can\'t be longer than 10');
            var res = {}
            res.form = 'form_comp';
            res.args = args;
            if (!lotsoferrors(errors)) {
                submitData('search', res);

            }

        } catch (e) {
            console.log(e.stack);
        } finally {
            return false; // to avoid page reload
        } // to avoid page reload

    })

    $("#form_tasks").submit(function () {
        try {
            var args = {};
            var errors = []
            args = checkedValues("#form_tasks input:checkbox:checked");



            submitData('deleteresults', args);
            //alert(args);;

        } catch (e) {
            console.log(e.stack);
        } finally {
            return false; // to avoid page reload
        } // to avoid page reload

    })

    $("#form_csv").submit(function(){
        try{
            var errors = [];
            var res={};
            var genfile = $('#genfile_c').is(':checked') ? true : false;

            if(components.length==0){
                errors.push('components list is empty');
            }

            if(!lotsoferrors(errors)){
                res.form="form_csv";
                res.args=components.file;
                res.components=components.components;
                res.genfile=genfile;

                submitData('components', res);
            }
        }catch(e){
            console.log(e.stack);
        }finally{
            return false;
        }
    })

    $("#form_admin").submit(function () {
        try {
            var args = {};
            args.databases = $("#databases option:selected").attr("value");

            submitData('recreate_view', args);
            //alert(args);;

        } catch (e) {
            console.log(e.stack);
        } finally {
            return false; // to avoid page reload
        } // to avoid page reload

    })

    $("#form_generate").submit(function () {
        try {

        } catch (e) {
            console.log(e.stack);
        } finally {
            return false; // to avoid page reload
        } // to avoid page reload
    })

    function done() {
        $(':submit').removeAttr('disabled');
        $('div #myItem1').invisible();
    }

    function submitData(channel, data) {
        socket.emit(channel, data);
        $('div #myItem1').visible();
    }

    var checkField = function (text, condition) {
        return (text.length > condition) ? false : true;
    }

    var lotsoferrors = function (errors) {
        var err;
        if (errors instanceof Array) {
            err = errors;
        } else {// object kv pairs
            err = [];
            Object.keys(errors).forEach((k) => {

                err.push('<span class="error">' + k + ':</span> ' + errors[k]);
            })

        }
        if (err.length > 0) {
            $("#form_errors").empty();

            $("#form_errors").append('<div id="errors"><h3>Error!</h3><span onclick="this.parentElement.style.display=\'none\'"  class="w3-button w3-display-topright">X</span></div>');
            var s;
            err.forEach((val) => { $("#errors").append(val + '<br/>') });
            return true;

        } else {
            $("#errors").remove();
            return false;
        }
    }

    var checkedValues = function (name) {
        return $(name).map(function () {
            return this.id;
        }).get();
    }

    function openTab(evt, tabName) {
        var i;
        var x = document.getElementsByClassName("tab");
        for (i = 0; i < x.length; i++) {
            x[i].style.display = "none";
        }

        tablinks = document.getElementsByClassName("tablink");
        for (i = 0; i < x.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" w3-red", "");
        }
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " w3-red";
    }

    /* Generate DOCX from template */

    var Generator = function () { };

    Generator.prototype.generateDocx = function (url, obj) {
        this.loadFile(url, obj, this.createDocx)
    }

    Generator.prototype.loadFile = function (url, obj, callback) {

        var self = this;


        self._obj = obj;
        self.url = url;

        JSZipUtils.getBinaryContent(url, function (error, content) {
            if (error) { throw error };
            var zip = new JSZip(content);
            var doc = new Docxtemplater().loadZip(zip)
            doc.setData(self._obj);

            try {
                // render the document (replace all occurences of {first_name} by John, {last_name} by Doe, ...)
                doc.render()
            }
            catch (error) {
                var e = {
                    message: error.message,
                    name: error.name,
                    stack: error.stack,
                    properties: error.properties,
                }
                console.log(JSON.stringify({ error: e }));
                // The error thrown here contains additional information when logged with JSON.stringify (it contains a property object).
                throw error;
            }

            var out = doc.getZip().generate({
                type: "blob",
                mimeType: "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
            }) //Output the document using Data-URI
            saveAs(out, "output.docx")
        });
    }


    Generator.prototype.createDocx = function (error, content) {
        if (error) { throw error };
        var zip = new JSZip(content);
        var doc = new Docxtemplater().loadZip(zip)
        doc.setData(this._obj);

        try {
            // render the document (replace all occurences of {first_name} by John, {last_name} by Doe, ...)
            doc.render()
        }
        catch (error) {
            var e = {
                message: error.message,
                name: error.name,
                stack: error.stack,
                properties: error.properties,
            }
            console.log(JSON.stringify({ error: e }));
            // The error thrown here contains additional information when logged with JSON.stringify (it contains a property object).
            throw error;
        }

        var out = doc.getZip().generate({
            type: "blob",
            mimeType: "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
        }) //Output the document using Data-URI
        saveAs(out, "output.docx")
    }

    function removeOptions(selectbox) {
        var i;
        for (i = selectbox.options.length - 1; i >= 0; i--) {
            selectbox.remove(i);
        }
    }

    function handleFiles(event) {
        var file = event.target.files[0];
        components.file.name=file.name;
        components.file.size=file.size;
        components.file.mimeType=file.mimeType;

        var reader = new LineReader();

        var hasHeader= $('#hasHeader').is(':checked') ? true : false;
        var header=[];


        reader.on('line', function (line, next) {
            // Do something with line....

            if(hasHeader&&header.length==0){
                header=line.split(',');
            }else{

            var array = line.split(',');
            var obj={};
            for(var i=0;i<array.length;i++){
                obj[header[i]]=""+array[i]+"";
            }
            components.components.push(obj);

            }

       
            next(); // Call next to resume...
        });

        reader.on('end',function(evt){
            console.log(components);
        })

        reader.read(file);
    }

</script>

			</div>
		</div>
		<div id="form_errors"></div>





	</section>



</body>

</html>